<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Todo List</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" integrity="sha512-Evv84Mr4kqVGRNSgIGL/F/aIDqQb7xQ2vcrdIwxfjThSH8CSR7PBEakCr51Ck+w+/U6swU2Im1vVX0SVk9ABhg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="todo.css">
    <style>
    </style>
</head>

<body>
   <div class="container">
    <h2>TodoInput</h2>
    <div class="todo-input">
        <div class="row">
            <i class="fa-solid fa-book"></i>
            <input type="text" id="input-box" placeholder="New Todo" >
        </div> 
        <p id="error-message" class="error-message"></p>
        <button id="add-task">Add new task</button>
    </div>

    <h2>TodoList</h2>
    

    <div class="filter-buttons">
        <button id="show-all" data-filter="all">All</button>
        <button class="show-done" data-filter="show-done">Done</button>
        <button class="show-todo" data-filter="todo">Todo</button>
    </div>
    <div id="task-list"></div>

    <div class="delete-buttons">
        <button class="delete-done">Delete done tasks</button>
        <button class="delete-all">Delete all tasks</button>
    </div>
   </div>
   <div id="deleteModal" class="modal">
    <div class="modal-content">
        <h3>Delete Task</h3>
        <p>Are you sure you want to delete this task?</p>
        <button id="confirmDelete">Confirm</button>
        <button id="cancelDelete" style="background-color:  #e06666; color: white;">Cancel</button>
    </div>
</div>
<div id="editModal" class="modal">
    <div class="modal-content">
        <h3>Edit Task</h3>
        <input type="text" id="edit-input">
        <button id="saveEdit">Save</button>
        <button id="cancelEdit">Cancel</button>
    </div>
</div>
    <script>
let tasks = [];
let showAllTasks = false;
const inputBox = document.getElementById("input-box");
const errorMessage = document.getElementById("error-message");
const taskList = document.getElementById("task-list");
const addTaskBtn = document.getElementById("add-task");
const showAllBtn = document.getElementById("show-all");
const deleteModal = document.getElementById("deleteModal");
const editModal = document.getElementById("editModal");
const editInput = document.getElementById("edit-input");
let taskToDeleteIndex = null;
let taskToEditIndex = null;

inputBox.addEventListener("input", function () {
    const task = inputBox.value.trim();
    if (task === "") {
        errorMessage.textContent = "Task cannot be empty";
    } else if (/^\d/.test(task)) {
        errorMessage.textContent = "Task cannot start with a number";
    } else if (task.length < 5) {
        errorMessage.textContent = "Task must be at least 5 characters long";
    } else {
        errorMessage.textContent = "";
    }
});

addTaskBtn.addEventListener("click", () => {
    const taskText = inputBox.value.trim();
    if (taskText !== "" && errorMessage.textContent === "") {
        tasks.push({ text: taskText, done: false });
        inputBox.value = "";
        renderTasks();
    }
});

showAllBtn.addEventListener("click", () => {
    showAllTasks = !showAllTasks;
    renderTasks();
});

function renderTasks() {
    taskList.innerHTML = "";
    if (showAllTasks) {
        tasks.forEach((task, index) => {
            const taskDiv = document.createElement("div");
            taskDiv.className = "task-item";

            const checkbox = document.createElement("input");
            checkbox.type = "checkbox";
            checkbox.checked = task.done;
            checkbox.addEventListener("change", () => {
                tasks[index].done = checkbox.checked;
                renderTasks();
            });

            const taskText = document.createElement("span");
            taskText.textContent = task.text;
            if (task.done) {
                taskText.classList.add("done");
            }

            const editIcon = document.createElement("button");
            editIcon.className = "edit-btn-yellow";
            editIcon.innerHTML = '<i class="fa-solid fa-pen"></i>';
            editIcon.addEventListener("click", () => {
                taskToEditIndex = index;
                editInput.value = tasks[index].text;
                editModal.style.display = "block";
            });

            const deleteIcon = document.createElement("button");
            deleteIcon.className = "edit-btn";
            deleteIcon.innerHTML = '<i class="fa-solid fa-trash"></i>';
            deleteIcon.addEventListener("click", () => {
                taskToDeleteIndex = index;
                deleteModal.style.display = "block";
            });

            taskDiv.appendChild(checkbox);
            taskDiv.appendChild(taskText);
            taskDiv.appendChild(editIcon);
            taskDiv.appendChild(deleteIcon);
            taskList.appendChild(taskDiv);
        });
    }
}

document.getElementById("confirmDelete").addEventListener("click", () => {
    if (taskToDeleteIndex !== null) {
        tasks.splice(taskToDeleteIndex, 1);
        renderTasks();
        deleteModal.style.display = "none";
    }
});

document.getElementById("cancelDelete").addEventListener("click", () => {
    deleteModal.style.display = "none";
});

document.getElementById("saveEdit").addEventListener("click", () => {
    if (taskToEditIndex !== null && editInput.value.trim() !== "") {
        tasks[taskToEditIndex].text = editInput.value.trim();
        renderTasks();
        editModal.style.display = "none";
    }
});

document.getElementById("cancelEdit").addEventListener("click", () => {
    editModal.style.display = "none";
});
    </script>
</body>
</html>